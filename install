function install(addr, fn) 
  term.clear()
  term.setCursorPos(1,1)
  print("Installing..."..fn)
  shell.run("wget "..addr.." "..fn)
end

function centerText(txt, offset)
  w, h = term.getSize()
  
  term.setCursorPos(w / 2 - math.floor(string.len(txt) / 2), h / 2 + offset)
  print(txt)
end

function writeText(txt, offset)
  w, h = term.getSize()
  
  term.setCursorPos(w / 2 - math.floor(string.len(txt) / 2), h / 2 + offset)
  write(txt)
end

function installAll()
  fs.makeDir("rSettings")
  fs.makeDir("rOS")
  fs.makeDir("rPrograms")
  fs.makeDir("rPaints")
  fs.makeDir("rPrograms/userPrograms")
  fs.makeDir("rApis")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/temp", "temp")
  fs.copy("temp", "rSettings/username")
  un = fs.open("rSettings/username", "w")
  un.writeLine(username)
  un.close()
  fs.copy("temp", "rSettings/password")
  pass = fs.open("rSettings/password", "w")
  pass.writeLine(password)
  pass.close()
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/startup", "startup")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/rOS/desktop", "rOS/desktop")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/rPrograms/console", "rPrograms/console")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/rPaints/startMenu", "rPaints/startMenu")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/rPrograms/installer", "rPrograms/installer")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/rPaints/icon", "rPaints/icon")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/apis/check", "rApis/check")
  install("https://raw.githubusercontent.com/Raven0S/RavenOS-2.0/master/apis/text", "rApis/text")
  shell.run("set shell.allow_disk_startup false")
  os.reboot()
end

print("Are you sure you want to install RavenOS? (Y/n)")

while true do 
  write("> ")
  option = read()
   
  if string.lower(option) == "yes" then
    break
  elseif string.lower(option) == "y" then
    break
  elseif string.lower(option) == "ya" then
    break  
  elseif string.lower(option) == "yep" then
    break
  elseif string.lower(option) == "no" then
    print("Installation cancelled!")
    return
  elseif string.lower(option) == "n" then
    print("Installation cancelled!")
    return
  elseif string.lower(option) == "nah" then
    print("Installation cancelled!")
    return
  elseif string.lower(option) == "nope" then
    print("Installation cancelled!")
    return    
  else
    print("Invalid Command")
  end
end

term.setBackgroundColor(colors.cyan)
term.clear()
term.setCursorPos(1,1)
centerText("RavenOS", -2)
centerText("Username:              ", 0)
centerText("Password:              ", 1)
term.setTextColor(colors.lightBlue)
centerText("Install", 3)
term.setTextColor(colors.white)
term.setCursorPos(24,9)
username = read()
term.setCursorPos(24,10)
password = read()
writeText("Install", 3)

while true do 
  event, button, x, y = os.pullEvent("mouse_click")
  if button == 1 and y == 12 then
    installAll()
    break
  end
end
